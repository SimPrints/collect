<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms"
        xmlns:h="http://www.w3.org/1999/xhtml"
        xmlns:ev="http://www.w3.org/2001/xml-events"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema"
        xmlns:jr="http://openrosa.org/javarosa">
    <h:head>
        <h:title>Simprints Registration Example</h:title> 
        <model>

            <instance>
                <form id="registrationExample">
                    <userId/>
                    <simprints>
                        <apiKey />
                        <moduleId />
                    </simprints>
                    <name />
                    <guid />
                </form>
            </instance>


            <bind nodeset="/form/userId" type="string" jr:preload="property" jr:preloadParams="username"/> 
            <!-- Pull Simprints API key from csv -->
            <bind nodeset="/form/simprints/apiKey" calculate="pulldata('simprints', 'value', 'sim_key', 'apiKey')"/>
            <bind nodeset="/form/simprints/moduleId" calculate="pulldata('simprints', 'value', 'sim_key', 'moduleId')"/>
            
            <bind nodeset="/form/name" type="string"/>
            <bind nodeset="/form/guid" type="string"/>

            <itext>
                <translation lang="English">
                    <text id="nameText">
                        <value>Name</value>
                    </text>
                    <text id="registerText">
                        <!-- value = prompt shown above button -->
                        <value>Register Person</value>
                        <!-- buttonText = the prompt shown on the button -->
                        <value form="buttonText">Launch Simprints</value>
                        <!-- noAppErrorString = toast displayed when Simprints can't be found -->
                        <value form="noAppErrorString">Simprints is not installed! Please contact your administrator.</value>
                    </text>
                </translation>
            </itext>

        </model>
    </h:head>
    <h:body>
        <input ref="/form/name">
            <label ref="jr:itext('nameText')"/>
        </input>
        <input ref="/form/guid" appearance="simprints:REGISTER(apiKey=/form/simprints/apiKey, userId=/form/userId, moduleId=/form/simprints/moduleId)">
            <label ref="jr:itext('registerText')"/>
        </input>
    </h:body>
</h:html>
